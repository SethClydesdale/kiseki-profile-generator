!function(e,t){"use strict";e.offlineEdge="file:"==e.location.protocol&&/Edge/.test(navigator.userAgent),e.storageOK=!(!navigator.cookieEnabled||offlineEdge||!e.localStorage),e.AeonSystem={kidou:function(){if("file:"==e.location.protocol)for(var a=t.getElementsByTagName("A"),o=0,n=a.length;o<n;o++)/http/.test(a[o].href)||(/\/$/.test(a[o].href)?a[o].href+="index.html":/\/#.*?$/.test(a[o].href)?a[o].href=a[o].href.replace(/(#.*?)$/,"index.html$1"):/\/\?.*?$/.test(a[o].href)&&(a[o].href=a[o].href.replace(/(\?.*?)$/,"index.html$1")))},profile:{lang:"en",background:"sora",gender:"null",name:"",nameColor:"#000",handle:"",handleColor:"#000",sky1:!1,sky2:!1,sky3:!1,zero:!1,ao:!1,sen1:!1,sen2:!1,sen3:!1,sen4:!1,haji:!1,kuro1:!1,nayuta:!1,ysvskiseki:!1,otherGames:"",otherGamesColor:"#000",favgame:"",favgameColor:"#000",favchar:"",favcharColor:"#000",favpair:"",favpairColor:"#000",about:"",aboutColor:"#000"},updateProfile:function(e,a){switch(a){case"lang":(o=t.getElementById("template")).className=o.className.replace(/(?:en|ja)-lang/,e.value+"-lang"),AeonSystem.profile.lang=e.value;break;case"avatar":t.getElementById("kp-avatar").src=URL.createObjectURL(e.files[0]),t.getElementById("info-avatar").value="";break;case"background":(o=t.getElementById("template")).className=o.className.replace(/(?:sora|crossbell|sen|kuro)-bg/,e.value+"-bg"),AeonSystem.profile.background=e.value;break;case"gender":var o;(o=t.getElementById("template")).className=o.className.replace(/(?:null|male|female|other)-gender/,e.value+"-gender"),AeonSystem.profile.gender=e.value;break;case"text":var n=e.id.replace("info-","");t.getElementById("kp-"+n).innerText=e.value,AeonSystem.profile[n]=e.value;break;case"fontColor":n=e.id.replace("info-","");t.getElementById("kp-"+n.replace("Color","")).style.color=e.value,AeonSystem.profile[n]=e.value;break;case"checkbox":n=e.id.replace("info-","");var s=t.getElementById("kp-"+n);e.checked?s.className+=" played":s.className=s.className.replace(" played",""),AeonSystem.profile[n]=e.checked}AeonSystem.saveProfile()},saveProfile:function(){storageOK&&(localStorage.kisekiProfile=JSON.stringify(AeonSystem.profile))},restoreProfile:function(e){if(storageOK&&localStorage.kisekiProfile||e){e||(AeonSystem.profile=JSON.parse(localStorage.kisekiProfile));for(var a in AeonSystem.profile){var o=t.getElementById("info-"+a);o?"INPUT"==o.tagName&&"checkbox"==o.type&&1==AeonSystem.profile[a]?o.click():(o.value=AeonSystem.profile[a],o.dispatchEvent(new Event("SELECT"==o.tagName?"change":"input"))):console.error(o,a,AeonSystem.profile[a])}}},generateProfile:function(){html2canvas(t.getElementById("template")).then(function(e){var a=t.createElement("A");a.href=e.toDataURL(),a.download="kiseki-profile.png",a.click()})},downloadProfile:function(){var e=t.createElement("A");e.href="data:,"+encodeURIComponent(JSON.stringify(AeonSystem.profile,"","  ").replace(/\n/g,"\r\n")),e.download="kiseki-profile.json",e.click()},uploadProfile:function(e,a){var o=a?e:e.files[0],n=new FileReader;n.onload=function(e){AeonSystem.profile=JSON.parse(e.target.result),AeonSystem.restoreProfile(!0),t.getElementById("fileLoader").value=""},n.readAsText(o,"UTF-8")},dropFile:function(e){AeonSystem.uploadProfile(e.dataTransfer.files[0],!0),e.preventDefault()},getPaths:function(){var t=e.location.pathname;return/\/contact\//.test(t)?"../":""},limitBreak:function(e){if(AeonSystem.activated){if(!AeonSystem.animating){a=AeonSystem.getPaths();AeonSystem.audio.mysticCore.paused?(AeonSystem.audio.mysticCore.play(),e.parentNode.className="tio-limit-break",e.src=a+"aeon-system/images/tio-aeon-system.png"):(AeonSystem.audio.mysticCore.pause(),e.parentNode.className="",e.src=a+"aeon-system/images/tio-staff.png")}}else{var a=AeonSystem.getPaths();AeonSystem.activated=!0,AeonSystem.animating=!0,AeonSystem.intro=t.getElementById("intro-bubble"),AeonSystem.introText=AeonSystem.intro.innerHTML,t.body.className+=" aeon-system-active";var o=t.getElementById("button-options");o&&(o.style.paddingRight="300px"),AeonSystem.audio={kidou:t.getElementById("aeon-system-kidou"),limitBreak:t.getElementById("aeon-system-limit-break"),mysticCore:t.getElementById("mystic-core")},e.src=a+"aeon-system/images/tio-staff.png",AeonSystem.audio.kidou.play(),AeonSystem.intro.innerHTML='<span class="aeon-system-dialogue">Aeon system, activate.</span>',setTimeout(function(){AeonSystem.audio.mysticCore.play(),setTimeout(function(){e.src=a+"aeon-system/images/tio-aeon-system.png",setTimeout(function(){AeonSystem.audio.limitBreak.play(),AeonSystem.intro.innerHTML='<span class="aeon-system-dialogue">Aeon system, limit break!</span>',setTimeout(function(){e.parentNode.className="tio-limit-break",AeonSystem.animating=!1,setTimeout(function(){AeonSystem.intro.innerHTML='<span class="aeon-system-dialogue">You can stop the music at any time by *sigh* clicking me..</span>',setTimeout(function(){AeonSystem.intro.innerHTML=AeonSystem.introText},6e3)},1e3)},2200)},3e3)},500)},1e3)}},giveMishy:function(e){var a=t.getElementById("tio-plato"),o=t.getElementById("mishy");AeonSystem.audio2={ahMishy:t.getElementById("tio-ah-mishy"),mishy:t.getElementById("tio-mishy"),arigatou:t.getElementById("tio-arigatou")},e.style.visibility="hidden",e.onclick=null,o.style.visibility="",setTimeout(function(){a.src="aeon-system/images/tio-plato.png",AeonSystem.audio2.ahMishy.play(),setTimeout(function(){a.src="aeon-system/images/tio-plato-excited.png",setTimeout(function(){o.src="aeon-system/images/mishy-run.png",o.className="runLeft",a.className="runLeft",setTimeout(function(){o.className="runRight",a.className="runRight",setTimeout(function(){o.className="runBack",a.className="runBack",setTimeout(function(){o.style.display="none",a.className="",a.src="aeon-system/images/tio-and-mishy.png",AeonSystem.audio2.mishy.play(),setTimeout(function(){a.src="aeon-system/images/tio-and-mishy-excited.png",AeonSystem.audio2.arigatou.play()},1500)},3e3)},3e3)},3e3)},1e3)},1e3)},500)}}}(window,document);