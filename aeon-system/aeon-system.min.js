!function(o,e){"use strict";o.offlineEdge="file:"==o.location.protocol&&/Edge/.test(navigator.userAgent),o.storageOK=!(!navigator.cookieEnabled||offlineEdge||!o.localStorage),o.AeonSystem={kidou:function(){var t=e.getElementById("info-lang");if(/lang=(?:en|ja)/.test(o.location.search.toLowerCase())&&t&&(t.value=/ja/.test(o.location.search.toLowerCase())?"ja":"en",t.dispatchEvent(new Event("change"))),"file:"==o.location.protocol)for(var n=e.getElementsByTagName("A"),a=0,i=n.length;a<i;a++)/http/.test(n[a].href)||(/\/$/.test(n[a].href)?n[a].href+="index.html":/\/#.*?$/.test(n[a].href)?n[a].href=n[a].href.replace(/(#.*?)$/,"index.html$1"):/\/\?.*?$/.test(n[a].href)&&(n[a].href=n[a].href.replace(/(\?.*?)$/,"index.html$1")))},profile:{lang:"en",background:"sora",avatar:"estelle",avatarCustom:"",gender:"null",name:"",nameColor:"#333333",handle:"",handleColor:"#333333",sky1:!1,sky2:!1,sky3:!1,zero:!1,ao:!1,sen1:!1,sen2:!1,sen3:!1,sen4:!1,haji:!1,kuro1:!1,kuro2:!1,kai1:!1,nayuta:!1,ysvskiseki:!1,otherGames:"",otherGamesColor:"#333333",favgame:"",favgameColor:"#333333",favchar:"",favcharColor:"#333333",favpair:"",favpairColor:"#333333",about:"",aboutColor:"#333333",prevMode:"full"},cache:{},updateProfile:function(o,t){switch(t){case"lang":e.body.className=e.body.className.replace(/(?:en|ja)-lang/,o.value+"-lang");var n=(s=e.getElementById("info-avatar")).value;AeonSystem.cache.opts_avatar||(AeonSystem.cache.opts_avatar=e.getElementById("info-avatar").innerHTML),"en"==o.value?(s.innerHTML=AeonSystem.cache.opts_avatar,s.value=n):(s.innerHTML='<option value="custom">カスタム</option><optgroup label="空の軌跡"><option value="agate">アガット</option><option value="anelace">アネラス</option><option value="bleublanc">ブルブラン</option><option value="campanella">カンパネルラ</option><option value="cassius">カシウス</option><option value="gilbert">ギルバート</option><option value="estelle" selected>エステル</option><option value="josette">ジョゼット</option><option value="joshua">ヨシュア</option><option value="julia">ユリア</option><option value="kevin">ケビン</option><option value="kloe">クローゼ</option><option value="loewe">レーヴェ</option><option value="luciola">ルシオラ</option><option value="mueller">ミュラー</option><option value="not-mueller">ミュラーじゃない</option><option value="olivier">オリビエ</option><option value="Renne">レン</option><option value="richard">リシャール</option><option value="ries">リース</option><option value="scherazard">シェラザード</option><option value="tita">ティータ</option><option value="walter">ヴァルター</option><option value="weissmann">ワイスマン</option><option value="zin">ジン</option></optgroup><optgroup label="クロスベル"><option value="arianrhod">アリアンロード</option><option value="arios">アリオス</option><option value="cao">ツァオ</option><option value="dieter">ディーター</option><option value="dudley">ダドリー</option><option value="elie">エリィ</option><option value="fran">フラン</option><option value="garcia">ガルシア</option><option value="guy">ガイ</option><option value="ian">イアン</option><option value="ilya">イリア</option><option value="jingo">ジンゴ</option><option value="joachim">ヨアヒム</option><option value="jona">ヨナ</option><option value="kea">キーア</option><option value="lloyd">ロイド</option><option value="mariabell">マリアベル</option><option value="mishy">みっしぃ</option><option value="noel">ノエル</option><option value="randy">ランディ</option><option value="dandy-randy">ダンディなランディ</option><option value="rixia">リーシャ</option><option value="sergei">セルゲイ</option><option value="sigmund">シグムント</option><option value="shirley">シャーリィ</option><option value="sully">シュリ</option><option value="tio">ティオ</option><option value="mishettio">みーしぇティオ</option><option value="wald">ヴァルド</option><option value="wazy">ワジ</option><option value="zeit">ツァイト</option></optgroup><optgroup label="閃の軌跡"><option value="alfin">アルフィン</option><option value="alisa">アリサ</option><option value="alisa-magical">まじかる☆アリサ</option><option value="angelica">アンゼリカ</option><option value="ash">アッシュ</option><option value="aurelia">オーレリア</option><option value="altina">アルティナ</option><option value="black-rabbit">ブラックラビット</option><option value="beryl">ベリル</option><option value="c">C</option><option value="celine">セリーヌ</option><option value="celine-human">セリーヌ（人間）</option><option value="claire">クレア</option><option value="crow">クロウ</option><option value="duvalie">デュバリィ</option><option value="elise">エリゼ</option><option value="elliot">エリオット</option><option value="emma">エマ</option><option value="ennea">エンネア</option><option value="fie">フィー</option><option value="gaius">ガイウス</option><option value="george">ジョルジュ</option><option value="ines">アイネス</option><option value="juna">ユウナ</option><option value="jusis">ユーシス</option><option value="kurt">クルト</option><option value="lapis">ラピス</option><option value="laura">ラウラ</option><option value="lechter">レクター</option><option value="machias">マキアス</option><option value="mcburn">マクバーン</option><option value="millium">ミリアム</option><option value="musse">ミュゼ</option><option value="nadia">ナーディア</option><option value="osborne">オズボーン</option><option value="rean">リィン</option><option value="rean-ogre">リィン（鬼）</option><option value="roselia">ローゼリア</option><option value="rufus">ルーファス</option><option value="rutger">ルトガー</option><option value="sara">サラ</option><option value="sharon">シャロン</option><option value="swin">スウィン</option><option value="toval">トヴァル</option><option value="towa">トワ</option><option value="victor">ヴィクター</option><option value="vita">ヴィータ</option></optgroup><optgroup label="黎の軌跡"><option value="aaron">アーロン</option><option value="agnès">アニエス</option><option value="bergard">ベルガルド</option><option value="celis">セリス</option><option value="dingo">ディンゴ</option><option value="elaine">エレイン</option><option value="ellroy">エルロイ</option><option value="emilia">エミリア</option><option value="feri">フェリ</option><option value="gerard">ジェラール</option><option value="hermès">エルメス</option><option value="ixs">イクス</option><option value="jorda">ヨルダ</option><option value="judith">ジュディス</option><option value="grimcat">ジュディ――怪盗グリムキャッツ</option><option value="kasim">カシム</option><option value="kurogane">クロガネ</option><option value="leon">リオン</option><option value="lucrezia">ルクレツィア</option><option value="mare">メア</option><option value="marielle">マリエル</option><option value="melchior">メルキオル</option><option value="nina">ニナ</option><option value="paulette">ポーレット</option><option value="quatre">カトル</option><option value="rené">ルネ</option><option value="risette">リゼット</option><option value="rocksmith">ロックスミス</option><option value="roy">ロイ</option><option value="shizuna">シズナ</option><option value="simeon">シメオン</option><option value="ulrica">ウルリカ</option><option value="van">ヴァン</option><option value="yumé">ユメ</option><option value="yun">ユン</option></optgroup><optgroup label="那由多の軌跡"><option value="creha">クレハ</option><option value="cygna">シグナ</option><option value="lyra">ライラ</option><option value="nayuta">ナユタ</option><option value="noi">ノイ</option></optgroup>',s.value=n);var a=e.getElementById("info-background");n=a.value;AeonSystem.cache.opts_bg||(AeonSystem.cache.opts_bg=e.getElementById("info-background").innerHTML),"en"==o.value?(a.innerHTML=AeonSystem.cache.opts_bg,a.value=n):(a.innerHTML='<option value="sora" default>空の軌跡</option><option value="sora2" default>空の軌跡2</option><option value="crossbell">クロスベル</option><option value="crossbell2">クロスベル2</option><option value="sen">閃の軌跡</option><option value="sen2">閃の軌跡2</option><option value="kuro">黎の軌跡</option><option value="kuro2">黎の軌跡2</option><option value="nayuta">那由多の軌跡</option><option value="nayuta2">那由多の軌跡2</option>',a.value=n);var i=e.getElementById("info-gender");n=i.value;AeonSystem.cache.opts_gender||(AeonSystem.cache.opts_gender=e.getElementById("info-gender").innerHTML),"en"==o.value?(i.innerHTML=AeonSystem.cache.opts_gender,i.value=n):(i.innerHTML='<option value="null" default>無し</option><option value="male">男</option><option value="female">女</option><option value="other">他</option>',i.value=n);var l=e.getElementById("info-prevMode");n=l.value;AeonSystem.cache.opts_prevMode||(AeonSystem.cache.opts_prevMode=e.getElementById("info-prevMode").innerHTML),"en"==o.value?(l.innerHTML=AeonSystem.cache.opts_prevMode,l.value=n):(l.innerHTML='<option value="full" default>丸見え</option><option value="zoom">ズーム</option>',l.value=n),AeonSystem.profile.lang=o.value;break;case"prevMode":var p=e.getElementById("preview-box");p&&(p.className="prev-"+o.value,AeonSystem.profile.prevMode=o.value);break;case"avatar":var s=e.getElementById("kp-avatar"),r=e.getElementById("avatar-prev"),u="url("+("custom"==o.value?AeonSystem.profile.avatarCustom:"aeon-system/avatar/"+o.value+".jpg")+")";s.style.backgroundImage=u,AeonSystem.profile.avatar=o.value,r&&(r.style.backgroundImage=u);break;case"avatarCustom":AeonSystem.profile.avatarCustom=URL.createObjectURL(o.files[0]),(c=e.getElementById("info-avatar")).value="custom",c.dispatchEvent(new Event("change")),AeonSystem.avatarOK(),e.getElementById("info-avatarCustom").value="";break;case"background":var v=e.getElementById("template");r=e.getElementById("bg-prev");v.className=v.className.replace(/(?:sora|sora2|crossbell|crossbell2|sen|sen2|kuro|kuro2|nayuta|nayuta2)-bg/,o.value+"-bg"),AeonSystem.profile.background=o.value,r&&(r.style.backgroundImage="url(aeon-system/template/"+o.value+".jpg)");break;case"gender":(v=e.getElementById("template")).className=v.className.replace(/(?:null|male|female|other)-gender/,o.value+"-gender"),AeonSystem.profile.gender=o.value;break;case"text":var m=o.id.replace("info-","");e.getElementById("kp-"+m).innerText=o.value,AeonSystem.profile[m]=o.value;break;case"fontColor":m=o.id.replace("info-","");e.getElementById("kp-"+m.replace("Color","")).style.color=o.value,AeonSystem.profile[m]=o.value;break;case"checkbox":m=o.id.replace("info-","");var c=e.getElementById("kp-"+m);o.checked?c.className+=" played":c.className=c.className.replace(" played",""),AeonSystem.profile[m]=o.checked}AeonSystem.saveProfile()},saveProfile:function(){storageOK&&(localStorage.kisekiProfile=JSON.stringify(AeonSystem.profile))},restoreProfile:function(o){if(storageOK&&localStorage.kisekiProfile||o){o||(AeonSystem.profile=JSON.parse(localStorage.kisekiProfile));for(var t in AeonSystem.profile){var n=e.getElementById("info-"+t);if(!/avatarCustom/.test(t))if(n)if("INPUT"==n.tagName&&"checkbox"==n.type){var a=e.getElementById("kp-"+t);a&&(a.className=a.className.replace(" played","")),n.checked=AeonSystem.profile[t],n.dispatchEvent(new Event("change"))}else n.value=AeonSystem.profile[t],n.dispatchEvent(new Event("SELECT"==n.tagName?"change":"input"));else console.error(n,t,AeonSystem.profile[t])}}},resetProfile:function(){if(confirm("en"==AeonSystem.profile.lang?"All fields will be reset. Do you want to continue?":"すべての情報をリセットします。よろしいですか？")){for(var o in AeonSystem.profile){var t=e.getElementById("info-"+o);"checkbox"==t.type?t.checked=!1:"lang"!=o&&(t.value="avatar"==o?"estelle":"background"==o?"sora":"gender"==o?"null":"prevMode"==o?"full":/Color/.test(o)?"#333333":""),t.dispatchEvent(new Event("SELECT"==t.tagName||"checkbox"==t.type?"change":"input"))}e.getElementById("kp-avatar").style.backgroundImage=""}},generateProfile:function(){var o=e.getElementById("preview-box"),t=!1;o&&/prev-full/.test(o.className)&&(o.className="",t=!0),html2canvas(e.getElementById("template")).then(function(o){var t=e.createElement("A");t.href=o.toDataURL(),t.download="kiseki-profile.png",t.click()}),t&&(o.className="prev-full")},downloadProfile:function(){var o=e.createElement("A");o.href="data:,"+encodeURIComponent(JSON.stringify(AeonSystem.profile,"","  ").replace(/\n/g,"\r\n")),o.download="kiseki-profile.json",o.click()},uploadProfile:function(o,t){var n=t?o:o.files[0],a=new FileReader;a.onload=function(o){AeonSystem.profile=JSON.parse(o.target.result),AeonSystem.restoreProfile(!0),e.getElementById("fileLoader").value=""},a.readAsText(n,"UTF-8")},dropFile:function(o){AeonSystem.uploadProfile(o.dataTransfer.files[0],!0),o.preventDefault()},avatarOK:function(){AeonSystem.avatarPrompt&&clearTimeout(AeonSystem.avatarPrompt),e.getElementById("uploadOK").style.display="",AeonSystem.avatarPrompt=setTimeout(function(){e.getElementById("uploadOK").style.display="none",delete AeonSystem.avatarPrompt},3e3)},getPaths:function(){var e=o.location.pathname;return/\/contact\//.test(e)?"../":""},limitBreak:function(o){if(AeonSystem.activated){if(!AeonSystem.animating){t=AeonSystem.getPaths();AeonSystem.audio.mysticCore.paused?(AeonSystem.audio.mysticCore.play(),o.parentNode.className="tio-limit-break",o.src=t+"aeon-system/images/tio-aeon-system.png"):(AeonSystem.audio.mysticCore.pause(),o.parentNode.className="",o.src=t+"aeon-system/images/tio-staff.png")}}else{var t=AeonSystem.getPaths();AeonSystem.activated=!0,AeonSystem.animating=!0,AeonSystem.intro=e.getElementById("intro-bubble"),AeonSystem.introText=AeonSystem.intro.innerHTML,e.body.className+=" aeon-system-active";var n=e.getElementById("button-options");n&&(n.style.paddingRight="300px"),AeonSystem.audio={kidou:e.getElementById("aeon-system-kidou"),limitBreak:e.getElementById("aeon-system-limit-break"),mysticCore:e.getElementById("mystic-core")},o.src=t+"aeon-system/images/tio-staff.png",AeonSystem.audio.kidou.play(),AeonSystem.intro.innerHTML='<span class="aeon-system-dialogue"><span class="en">Aeon system, activate.</span><span class="ja">エイオンシステム、起動。</span></span>',setTimeout(function(){AeonSystem.audio.mysticCore.play(),setTimeout(function(){o.src=t+"aeon-system/images/tio-aeon-system.png",setTimeout(function(){AeonSystem.audio.limitBreak.play(),AeonSystem.intro.innerHTML='<span class="aeon-system-dialogue"><span class="en">Aeon system, limit break!</span><span class="ja">エイオンシステム、<ruby>制限解除<rt>リミットブレイク</rt></ruby>！</span></span>',setTimeout(function(){o.parentNode.className="tio-limit-break",AeonSystem.animating=!1,setTimeout(function(){AeonSystem.intro.innerHTML='<span class="aeon-system-dialogue"><span class="en">You can stop the music at any time by clicking me...</span><span class="ja">音楽を止めたかったら、私をクリックしてください……</span></span>',setTimeout(function(){AeonSystem.intro.innerHTML=AeonSystem.introText},6e3)},1e3)},2200)},3e3)},500)},1e3)}},giveMishy:function(o){var t=e.getElementById("tio-plato"),n=e.getElementById("mishy");AeonSystem.audio2={ahMishy:e.getElementById("tio-ah-mishy"),mishy:e.getElementById("tio-mishy"),arigatou:e.getElementById("tio-arigatou")},o.style.visibility="hidden",o.onclick=null,n.style.visibility="",setTimeout(function(){t.src="aeon-system/images/tio-plato.png",AeonSystem.audio2.ahMishy.play(),setTimeout(function(){t.src="aeon-system/images/tio-plato-excited.png",setTimeout(function(){n.src="aeon-system/images/mishy-run.png",n.className="runLeft",t.className="runLeft",setTimeout(function(){n.className="runRight",t.className="runRight",setTimeout(function(){n.className="runBack",t.className="runBack",setTimeout(function(){n.style.display="none",t.className="",t.src="aeon-system/images/tio-and-mishy.png",AeonSystem.audio2.mishy.play(),setTimeout(function(){t.src="aeon-system/images/tio-and-mishy-excited.png",AeonSystem.audio2.arigatou.play()},1500)},3e3)},3e3)},3e3)},1e3)},1e3)},500)}}}(window,document);