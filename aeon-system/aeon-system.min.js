!function(e,t){"use strict";e.offlineEdge="file:"==e.location.protocol&&/Edge/.test(navigator.userAgent),e.storageOK=!(!navigator.cookieEnabled||offlineEdge||!e.localStorage),e.AeonSystem={kidou:function(){var a=t.getElementById("info-lang");if(/lang=(?:en|ja)/.test(e.location.search.toLowerCase())&&a&&(a.value=/ja/.test(e.location.search.toLowerCase())?"ja":"en",a.dispatchEvent(new Event("change"))),"file:"==e.location.protocol)for(var o=t.getElementsByTagName("A"),n=0,s=o.length;n<s;n++)/http/.test(o[n].href)||(/\/$/.test(o[n].href)?o[n].href+="index.html":/\/#.*?$/.test(o[n].href)?o[n].href=o[n].href.replace(/(#.*?)$/,"index.html$1"):/\/\?.*?$/.test(o[n].href)&&(o[n].href=o[n].href.replace(/(\?.*?)$/,"index.html$1")))},profile:{lang:"en",background:"sora",gender:"null",name:"",nameColor:"#333333",handle:"",handleColor:"#333333",sky1:!1,sky2:!1,sky3:!1,zero:!1,ao:!1,sen1:!1,sen2:!1,sen3:!1,sen4:!1,haji:!1,kuro1:!1,nayuta:!1,ysvskiseki:!1,otherGames:"",otherGamesColor:"#333333",favgame:"",favgameColor:"#333333",favchar:"",favcharColor:"#333333",favpair:"",favpairColor:"#333333",about:"",aboutColor:"#333333"},updateProfile:function(e,a){switch(a){case"lang":t.body.className=t.body.className.replace(/(?:en|ja)-lang/,e.value+"-lang");var o=t.getElementById("info-background"),n=o.value;"en"==e.value?(o.innerHTML='<option value="sora" default>Sky</option><option value="crossbell">Crossbell</option><option value="sen">Cold Steel</option><option value="kuro">Kuro</option>',o.value=n):(o.innerHTML='<option value="sora" default>空の軌跡</option><option value="crossbell">クロスベル</option><option value="sen">閃の軌跡</option><option value="kuro">黎の軌跡</option>',o.value=n);var s=t.getElementById("info-gender");n=s.value;"en"==e.value?(s.innerHTML='<option value="null" default>N/A</option><option value="male">Male</option><option value="female">Female</option><option value="other">Other</option>',s.value=n):(s.innerHTML='<option value="null" default>無し</option><option value="male">男</option><option value="female">女</option><option value="other">他</option>',s.value=n),AeonSystem.profile.lang=e.value;break;case"avatar":t.getElementById("kp-avatar").style.backgroundImage="url("+URL.createObjectURL(e.files[0])+")",AeonSystem.avatarOK(),t.getElementById("info-avatar").value="";break;case"background":(i=t.getElementById("template")).className=i.className.replace(/(?:sora|crossbell|sen|kuro)-bg/,e.value+"-bg"),AeonSystem.profile.background=e.value;break;case"gender":var i;(i=t.getElementById("template")).className=i.className.replace(/(?:null|male|female|other)-gender/,e.value+"-gender"),AeonSystem.profile.gender=e.value;break;case"text":var l=e.id.replace("info-","");t.getElementById("kp-"+l).innerText=e.value,AeonSystem.profile[l]=e.value;break;case"fontColor":l=e.id.replace("info-","");t.getElementById("kp-"+l.replace("Color","")).style.color=e.value,AeonSystem.profile[l]=e.value;break;case"checkbox":l=e.id.replace("info-","");var r=t.getElementById("kp-"+l);e.checked?r.className+=" played":r.className=r.className.replace(" played",""),AeonSystem.profile[l]=e.checked}AeonSystem.saveProfile()},saveProfile:function(){storageOK&&(localStorage.kisekiProfile=JSON.stringify(AeonSystem.profile))},restoreProfile:function(e){if(storageOK&&localStorage.kisekiProfile||e){e||(AeonSystem.profile=JSON.parse(localStorage.kisekiProfile));for(var a in AeonSystem.profile){var o=t.getElementById("info-"+a);o?"INPUT"==o.tagName&&"checkbox"==o.type?(o.checked=AeonSystem.profile[a],o.dispatchEvent(new Event("change"))):(o.value=AeonSystem.profile[a],o.dispatchEvent(new Event("SELECT"==o.tagName?"change":"input"))):console.error(o,a,AeonSystem.profile[a])}}},resetProfile:function(){if(confirm("en"==AeonSystem.profile.lang?"All fields will be reset. Do you want to continue?":"すべての情報をリセットします。よろしいですか？")){for(var e in AeonSystem.profile){var a=t.getElementById("info-"+e);"checkbox"==a.type?a.checked=!1:"lang"!=e&&(a.value="background"==e?"sora":"gender"==e?"null":/Color/.test(e)?"#333333":""),a.dispatchEvent(new Event("SELECT"==a.tagName||"checkbox"==a.type?"change":"input"))}t.getElementById("kp-avatar").style.backgroundImage=""}},generateProfile:function(){html2canvas(t.getElementById("template")).then(function(e){var a=t.createElement("A");a.href=e.toDataURL(),a.download="kiseki-profile.png",a.click()})},downloadProfile:function(){var e=t.createElement("A");e.href="data:,"+encodeURIComponent(JSON.stringify(AeonSystem.profile,"","  ").replace(/\n/g,"\r\n")),e.download="kiseki-profile.json",e.click()},uploadProfile:function(e,a){var o=a?e:e.files[0],n=new FileReader;n.onload=function(e){AeonSystem.profile=JSON.parse(e.target.result),AeonSystem.restoreProfile(!0),t.getElementById("fileLoader").value=""},n.readAsText(o,"UTF-8")},dropFile:function(e){AeonSystem.uploadProfile(e.dataTransfer.files[0],!0),e.preventDefault()},avatarOK:function(){AeonSystem.avatarPrompt&&clearTimeout(AeonSystem.avatarPrompt),t.getElementById("uploadOK").style.display="",AeonSystem.avatarPrompt=setTimeout(function(){t.getElementById("uploadOK").style.display="none",delete AeonSystem.avatarPrompt},3e3)},getPaths:function(){var t=e.location.pathname;return/\/contact\//.test(t)?"../":""},limitBreak:function(e){if(AeonSystem.activated){if(!AeonSystem.animating){a=AeonSystem.getPaths();AeonSystem.audio.mysticCore.paused?(AeonSystem.audio.mysticCore.play(),e.parentNode.className="tio-limit-break",e.src=a+"aeon-system/images/tio-aeon-system.png"):(AeonSystem.audio.mysticCore.pause(),e.parentNode.className="",e.src=a+"aeon-system/images/tio-staff.png")}}else{var a=AeonSystem.getPaths();AeonSystem.activated=!0,AeonSystem.animating=!0,AeonSystem.intro=t.getElementById("intro-bubble"),AeonSystem.introText=AeonSystem.intro.innerHTML,t.body.className+=" aeon-system-active";var o=t.getElementById("button-options");o&&(o.style.paddingRight="300px"),AeonSystem.audio={kidou:t.getElementById("aeon-system-kidou"),limitBreak:t.getElementById("aeon-system-limit-break"),mysticCore:t.getElementById("mystic-core")},e.src=a+"aeon-system/images/tio-staff.png",AeonSystem.audio.kidou.play(),AeonSystem.intro.innerHTML='<span class="aeon-system-dialogue"><span class="en">Aeon system, activate.</span><span class="ja">エイオンシステム、起動。</span></span>',setTimeout(function(){AeonSystem.audio.mysticCore.play(),setTimeout(function(){e.src=a+"aeon-system/images/tio-aeon-system.png",setTimeout(function(){AeonSystem.audio.limitBreak.play(),AeonSystem.intro.innerHTML='<span class="aeon-system-dialogue"><span class="en">Aeon system, limit break!</span><span class="ja">エイオンシステム、<ruby>制限解除<rt>リミットブレイク</rt></ruby>！</span></span>',setTimeout(function(){e.parentNode.className="tio-limit-break",AeonSystem.animating=!1,setTimeout(function(){AeonSystem.intro.innerHTML='<span class="aeon-system-dialogue"><span class="en">You can stop the music at any time by clicking me...</span><span class="ja">音楽を止めたかったら、私をクリックします……</span></span>',setTimeout(function(){AeonSystem.intro.innerHTML=AeonSystem.introText},6e3)},1e3)},2200)},3e3)},500)},1e3)}},giveMishy:function(e){var a=t.getElementById("tio-plato"),o=t.getElementById("mishy");AeonSystem.audio2={ahMishy:t.getElementById("tio-ah-mishy"),mishy:t.getElementById("tio-mishy"),arigatou:t.getElementById("tio-arigatou")},e.style.visibility="hidden",e.onclick=null,o.style.visibility="",setTimeout(function(){a.src="aeon-system/images/tio-plato.png",AeonSystem.audio2.ahMishy.play(),setTimeout(function(){a.src="aeon-system/images/tio-plato-excited.png",setTimeout(function(){o.src="aeon-system/images/mishy-run.png",o.className="runLeft",a.className="runLeft",setTimeout(function(){o.className="runRight",a.className="runRight",setTimeout(function(){o.className="runBack",a.className="runBack",setTimeout(function(){o.style.display="none",a.className="",a.src="aeon-system/images/tio-and-mishy.png",AeonSystem.audio2.mishy.play(),setTimeout(function(){a.src="aeon-system/images/tio-and-mishy-excited.png",AeonSystem.audio2.arigatou.play()},1500)},3e3)},3e3)},3e3)},1e3)},1e3)},500)}}}(window,document);