!function(e,t){"use strict";e.offlineEdge="file:"==e.location.protocol&&/Edge/.test(navigator.userAgent),e.storageOK=!(!navigator.cookieEnabled||offlineEdge||!e.localStorage),e.AeonSystem={kidou:function(){var o=t.getElementById("info-lang");if(/lang=(?:en|ja)/.test(e.location.search.toLowerCase())&&o&&(o.value=/ja/.test(e.location.search.toLowerCase())?"ja":"en",o.dispatchEvent(new Event("change"))),"file:"==e.location.protocol)for(var a=t.getElementsByTagName("A"),n=0,i=a.length;n<i;n++)/http/.test(a[n].href)||(/\/$/.test(a[n].href)?a[n].href+="index.html":/\/#.*?$/.test(a[n].href)?a[n].href=a[n].href.replace(/(#.*?)$/,"index.html$1"):/\/\?.*?$/.test(a[n].href)&&(a[n].href=a[n].href.replace(/(\?.*?)$/,"index.html$1")))},profile:{lang:"en",background:"sora",gender:"null",name:"",nameColor:"#000000",handle:"",handleColor:"#000000",sky1:!1,sky2:!1,sky3:!1,zero:!1,ao:!1,sen1:!1,sen2:!1,sen3:!1,sen4:!1,haji:!1,kuro1:!1,nayuta:!1,ysvskiseki:!1,otherGames:"",otherGamesColor:"#000000",favgame:"",favgameColor:"#000000",favchar:"",favcharColor:"#000000",favpair:"",favpairColor:"#000000",about:"",aboutColor:"#000000"},updateProfile:function(e,o){switch(o){case"lang":t.body.className=t.body.className.replace(/(?:en|ja)-lang/,e.value+"-lang");var a=t.getElementById("info-background"),n=a.value;"en"==e.value?(a.innerHTML='<option value="sora" default>Sky</option><option value="crossbell">Crossbell</option><option value="sen">Cold Steel</option><option value="kuro">Kuro</option>',a.value=n):(a.innerHTML='<option value="sora" default>空の軌跡</option><option value="crossbell">クロスベル</option><option value="sen">閃の軌跡</option><option value="kuro">黎の軌跡</option>',a.value=n);var i=t.getElementById("info-gender");n=i.value;"en"==e.value?(i.innerHTML='<option value="null" default>N/A</option><option value="male">Male</option><option value="female">Female</option><option value="other">Other</option>',i.value=n):(i.innerHTML='<option value="null" default>無し</option><option value="male">男</option><option value="female">女</option><option value="other">他</option>',i.value=n),AeonSystem.profile.lang=e.value;break;case"avatar":var s=t.getElementById("kp-avatar");s.src=URL.createObjectURL(e.files[0]),s.style.display="",AeonSystem.avatarOK(),t.getElementById("info-avatar").value="";break;case"background":(l=t.getElementById("template")).className=l.className.replace(/(?:sora|crossbell|sen|kuro)-bg/,e.value+"-bg"),AeonSystem.profile.background=e.value;break;case"gender":var l;(l=t.getElementById("template")).className=l.className.replace(/(?:null|male|female|other)-gender/,e.value+"-gender"),AeonSystem.profile.gender=e.value;break;case"text":var r=e.id.replace("info-","");t.getElementById("kp-"+r).innerText=e.value,AeonSystem.profile[r]=e.value;break;case"fontColor":r=e.id.replace("info-","");t.getElementById("kp-"+r.replace("Color","")).style.color=e.value,AeonSystem.profile[r]=e.value;break;case"checkbox":r=e.id.replace("info-","");var m=t.getElementById("kp-"+r);e.checked?m.className+=" played":m.className=m.className.replace(" played",""),AeonSystem.profile[r]=e.checked}AeonSystem.saveProfile()},saveProfile:function(){storageOK&&(localStorage.kisekiProfile=JSON.stringify(AeonSystem.profile))},restoreProfile:function(e){if(storageOK&&localStorage.kisekiProfile||e){e||(AeonSystem.profile=JSON.parse(localStorage.kisekiProfile));for(var o in AeonSystem.profile){var a=t.getElementById("info-"+o);a?"INPUT"==a.tagName&&"checkbox"==a.type?(a.checked=AeonSystem.profile[o],a.dispatchEvent(new Event("change"))):(a.value=AeonSystem.profile[o],a.dispatchEvent(new Event("SELECT"==a.tagName?"change":"input"))):console.error(a,o,AeonSystem.profile[o])}}},resetProfile:function(){if(confirm("en"==AeonSystem.profile.lang?"All fields will be reset. Do you want to continue?":"すべての情報をリセットします。よろしいですか？")){for(var e in AeonSystem.profile){var o=t.getElementById("info-"+e);"checkbox"==o.type?o.checked=!1:"lang"!=e&&(o.value="background"==e?"sora":"gender"==e?"null":/Color/.test(e)?"#000000":""),o.dispatchEvent(new Event("SELECT"==o.tagName||"checkbox"==o.type?"change":"input"))}var a=t.getElementById("kp-avatar");a.src="",a.style.display="none"}},generateProfile:function(){html2canvas(t.getElementById("template")).then(function(e){var o=t.createElement("A");o.href=e.toDataURL(),o.download="kiseki-profile.png",o.click()})},downloadProfile:function(){var e=t.createElement("A");e.href="data:,"+encodeURIComponent(JSON.stringify(AeonSystem.profile,"","  ").replace(/\n/g,"\r\n")),e.download="kiseki-profile.json",e.click()},uploadProfile:function(e,o){var a=o?e:e.files[0],n=new FileReader;n.onload=function(e){AeonSystem.profile=JSON.parse(e.target.result),AeonSystem.restoreProfile(!0),t.getElementById("fileLoader").value=""},n.readAsText(a,"UTF-8")},dropFile:function(e){AeonSystem.uploadProfile(e.dataTransfer.files[0],!0),e.preventDefault()},avatarOK:function(){AeonSystem.avatarPrompt&&clearTimeout(AeonSystem.avatarPrompt),t.getElementById("uploadOK").style.display="",AeonSystem.avatarPrompt=setTimeout(function(){t.getElementById("uploadOK").style.display="none",delete AeonSystem.avatarPrompt},3e3)},getPaths:function(){var t=e.location.pathname;return/\/contact\//.test(t)?"../":""},limitBreak:function(e){if(AeonSystem.activated){if(!AeonSystem.animating){o=AeonSystem.getPaths();AeonSystem.audio.mysticCore.paused?(AeonSystem.audio.mysticCore.play(),e.parentNode.className="tio-limit-break",e.src=o+"aeon-system/images/tio-aeon-system.png"):(AeonSystem.audio.mysticCore.pause(),e.parentNode.className="",e.src=o+"aeon-system/images/tio-staff.png")}}else{var o=AeonSystem.getPaths();AeonSystem.activated=!0,AeonSystem.animating=!0,AeonSystem.intro=t.getElementById("intro-bubble"),AeonSystem.introText=AeonSystem.intro.innerHTML,t.body.className+=" aeon-system-active";var a=t.getElementById("button-options");a&&(a.style.paddingRight="300px"),AeonSystem.audio={kidou:t.getElementById("aeon-system-kidou"),limitBreak:t.getElementById("aeon-system-limit-break"),mysticCore:t.getElementById("mystic-core")},e.src=o+"aeon-system/images/tio-staff.png",AeonSystem.audio.kidou.play(),AeonSystem.intro.innerHTML='<span class="aeon-system-dialogue">Aeon system, activate.</span>',setTimeout(function(){AeonSystem.audio.mysticCore.play(),setTimeout(function(){e.src=o+"aeon-system/images/tio-aeon-system.png",setTimeout(function(){AeonSystem.audio.limitBreak.play(),AeonSystem.intro.innerHTML='<span class="aeon-system-dialogue">Aeon system, limit break!</span>',setTimeout(function(){e.parentNode.className="tio-limit-break",AeonSystem.animating=!1,setTimeout(function(){AeonSystem.intro.innerHTML='<span class="aeon-system-dialogue">You can stop the music at any time by *sigh* clicking me..</span>',setTimeout(function(){AeonSystem.intro.innerHTML=AeonSystem.introText},6e3)},1e3)},2200)},3e3)},500)},1e3)}},giveMishy:function(e){var o=t.getElementById("tio-plato"),a=t.getElementById("mishy");AeonSystem.audio2={ahMishy:t.getElementById("tio-ah-mishy"),mishy:t.getElementById("tio-mishy"),arigatou:t.getElementById("tio-arigatou")},e.style.visibility="hidden",e.onclick=null,a.style.visibility="",setTimeout(function(){o.src="aeon-system/images/tio-plato.png",AeonSystem.audio2.ahMishy.play(),setTimeout(function(){o.src="aeon-system/images/tio-plato-excited.png",setTimeout(function(){a.src="aeon-system/images/mishy-run.png",a.className="runLeft",o.className="runLeft",setTimeout(function(){a.className="runRight",o.className="runRight",setTimeout(function(){a.className="runBack",o.className="runBack",setTimeout(function(){a.style.display="none",o.className="",o.src="aeon-system/images/tio-and-mishy.png",AeonSystem.audio2.mishy.play(),setTimeout(function(){o.src="aeon-system/images/tio-and-mishy-excited.png",AeonSystem.audio2.arigatou.play()},1500)},3e3)},3e3)},3e3)},1e3)},1e3)},500)}}}(window,document);